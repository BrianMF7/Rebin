ğŸ§© ReBin Pro â€” Codebase Explained (Simplified & Technical)
ğŸ¯ What It Does

ReBin Pro helps users sort waste correctly.
You upload or take a photo of an item, and the app tells you whether it belongs in recycling, compost, or trash, along with a short explanation and eco-tip.
It uses computer vision to detect items and AI reasoning (via OpenRouter or Gemini) to explain the decision.

ğŸ—ï¸ Architecture Overview

Full-stack app with:

Frontend (React + TypeScript) â†’ user interface

Backend (FastAPI) â†’ handles AI calls and database

Cloudflare Worker â†’ image preprocessing + routing

Supabase (PostgreSQL) â†’ authentication and data storage

Mock CV Service â†’ local test for object detection

Docker â†’ containerized deployment for all services

ğŸ–¥ï¸ Frontend â€” React App

Purpose: The user-facing web app for uploading images, viewing results, and tracking impact.
Built with: React 18, TypeScript, React Query, TailwindCSS, Supabase JS SDK.

Key Files
File	Description
frontend/src/App.tsx	Main app entry point and route setup.
frontend/src/components/CameraUpload.tsx	Lets users take/upload a photo and enter ZIP code; sends to backend for analysis.
frontend/src/components/ResultCard.tsx	Displays AIâ€™s classification (Recycle/Compost/Trash) with confidence, reasoning, and eco-tip.
frontend/src/components/StatsPanel.tsx	Shows user progress and total COâ‚‚ saved.
frontend/src/lib/api.ts	Wrapper for backend HTTP requests (/infer, /explain, /event).
frontend/src/lib/supabase.ts	Configures Supabase Auth + DB client.
frontend/src/types/index.ts	Shared TypeScript interfaces (e.g., SortEvent, Item, Policy).

Frontend flow:
CameraUpload â†’ calls api.infer() â†’ backend returns detected items â†’ calls api.explain() â†’ shows in ResultCard â†’ logs event to Supabase â†’ updates StatsPanel.

âš™ï¸ Backend â€” FastAPI Server

Purpose: Core logic and integration with AI services and the database.
Built with: FastAPI, Pydantic, httpx/aiohttp (async HTTP), Supabase Python Client.

Key Files
File	Description
backend/main.py	App entry point; includes CORS setup and route registration.
backend/routes/infer.py	Receives photo, forwards to CV model (on Gradient or mock), returns detected items.
backend/routes/explain.py	Sends detected items + ZIP policy to OpenRouter/Gemini; returns bin decision, rationale, and eco-tip.
backend/routes/event.py	Logs the userâ€™s sort event and COâ‚‚ savings to Supabase.
backend/utils/openrouter_client.py	Handles OpenRouter API requests and response parsing.
backend/utils/supabase_client.py	Connects to Supabase for reading/writing data.
backend/schemas.py	Pydantic models for validation (e.g., Item, ExplainRequest, SortEvent).

Backend flow:
Receive image â†’ /infer detects items â†’ /explain decides bin type â†’ /event saves record â†’ sends combined JSON back to frontend.

ğŸŒ Edge Layer â€” Cloudflare Worker

Purpose: Lightweight preprocessing & orchestration at the edge for faster responses.

File	Description
cloudflare-worker/src/index.ts	Resizes uploaded image, reads ZIP param, fetches local recycling policy from KV storage, then forwards data to the backend (/infer, /explain). Combines responses into one JSON reply.

This reduces backend load and latency for common ZIP lookups.

ğŸ§  AI Services
Component	Description
Computer Vision (Model)	Deployed on DigitalOcean Gradient (or local mock). Detects items and materials in the image.
OpenRouter / Gemini	LLM used for reasoning â€” decides the correct bin and explains the logic in plain language.
ElevenLabs Voice	Converts short text feedback into speech for accessibility and â€œwow factor.â€
services/cv-mock/app.py	A small mock CV API returning sample detections for testing without a real GPU model.
ğŸ—„ï¸ Database â€” Supabase (PostgreSQL)

Stores all user data and statistics.
Tables

users: basic profile info (email, zip)

sort_events: one row per image processed (items, decision, COâ‚‚ saved)

policies: recycling rules by ZIP code (cached in Cloudflare KV)

âš™ï¸ Configuration & Infrastructure
File	Description
frontend/vite.config.ts, tailwind.config.js, tsconfig.json	Build, styling, and TypeScript configs.
backend/requirements.txt, backend/Dockerfile	Python deps & container setup.
docker-compose.yml	Runs frontend, backend, CV mock, and DB together.
.env.example (root + frontend + backend)	Template for all API keys and URLs.
services/cv-mock/Dockerfile	Container for mock CV service.
ğŸ”„ Complete Data Flow

User uploads photo in browser.

Cloudflare Worker compresses & forwards to backend with ZIP code.

Backend /infer â†’ CV model detects items.

Backend /explain â†’ AI model decides bins + reasoning.

Backend /event â†’ logs event + COâ‚‚ impact to Supabase.

Frontend displays results and plays ElevenLabs audio.

StatsPanel updates total items sorted and emissions saved.

ğŸ§° Key Technologies

Frontend: React + TypeScript + TailwindCSS + React Query

Backend: FastAPI + Pydantic + httpx + Supabase Client

Edge: Cloudflare Workers + KV Storage

AI: OpenRouter / Gemini (reasoning), Gradient CV model (detection), ElevenLabs TTS

Database: Supabase (PostgreSQL)

Deployment: Docker Compose + GoDaddy Domain

â–¶ï¸ How to Run Locally

Copy .env.example â†’ .env and fill in your API keys (Supabase, OpenRouter, ElevenLabs).

Run docker-compose up --build.

Visit http://localhost:5173
 â†’ upload a photo â†’ watch classification + reasoning appear.

Check Supabase dashboard â†’ see logged sort_events.

âœ… Summary

ReBin Pro is a full, modular AI application:

React frontend for user interaction

FastAPI backend for AI logic and DB I/O

Cloudflare edge for speed

Supabase database for persistent stats

OpenRouter + Gradient + ElevenLabs for the â€œAI magic.â€

All services talk to each other through clear REST APIs, making it easy to extend or replace components later.